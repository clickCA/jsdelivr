const e=()=>localStorage.getItem(`authToken`)||localStorage.getItem(`token`),t=(t=!0)=>{let n={"Content-Type":`application/json`};if(t){let t=e();t&&(n.Authorization=`Bearer ${t}`)}return n},n=async(e,n={})=>{try{let r=e.startsWith(`http`)?e:`http://localhost:8001/api/v1${e}`,i={...t(),...n.headers},a=await fetch(r,{...n,headers:i}),o=await a.json().catch(()=>({}));if(!a.ok){let e=o.message||`HTTP ${a.status}: ${a.statusText}`;throw a.status===401&&(localStorage.removeItem(`authToken`),localStorage.removeItem(`token`),console.warn(`Authentication failed - tokens cleared`)),Error(e)}return o}catch(e){throw e}},r={get:(e,t)=>n(e,{...t,method:`GET`}),post:(e,t,r)=>n(e,{...r,method:`POST`,body:t?JSON.stringify(t):void 0}),put:(e,t,r)=>n(e,{...r,method:`PUT`,body:t?JSON.stringify(t):void 0}),patch:(e,t,r)=>n(e,{...r,method:`PATCH`,body:t?JSON.stringify(t):void 0}),delete:(e,t)=>n(e,{...t,method:`DELETE`})};export{e as n,r as t};