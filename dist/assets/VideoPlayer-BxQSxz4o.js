import{t as e}from"./x-BUJseWii.js";import{Bt as t,E as n,F as r,Gt as i,T as a,Ut as o,en as s,j as c,tn as l,w as u}from"./index-DVxlyxEz.js";import{n as d,r as f,t as p}from"./alert-DfUrat1u.js";var m=r(),h=l(s(),1),g=l(t(),1);const _=e=>{if(!e||e<0)return``;let t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60);return t===0?`${n.toString().padStart(2,`0`)}:${r.toString().padStart(2,`0`)}`:`${t}:${n.toString().padStart(2,`0`)}:${r.toString().padStart(2,`0`)}`},v=t=>{let r=(0,m.c)(33),{referenceId:s,className:l,onCompleted:_}=t,{t:v}=i(`videoPlayer`),{activeContent:y}=a(),[C,w]=(0,h.useState)(!1),T=(0,h.useRef)(null),E=(0,h.useRef)(!1),D;r[0]===s?D=r[1]:(D={id:s},r[0]=s,r[1]=D);let O=!s,k;r[2]!==D||r[3]!==O?(k={variables:D,skip:O},r[2]=D,r[3]=O,r[4]=k):k=r[4];let{data:A,loading:j}=o(u,k),M;r[5]!==y?.contentId||r[6]!==_?(M=()=>{y?.contentId&&(w(!0),_?.(),n.getState().setShouldRefetch(!0))},r[5]=y?.contentId,r[6]=_,r[7]=M):M=r[7];let N=M,P;r[8]!==l||r[9]!==A||r[10]!==N?(P=()=>{let e=document.createElement(`div`);e.id=`youtube-player`,e.className=l||``;let t=document.getElementById(`video-container`);if(t&&(t.innerHTML=``,t.appendChild(e)),!A||E.current)return;let n=(A.getLesson?.contents||[]).find(b)?.url;if(!n)return;let r=new URLSearchParams(new URL(n).search).get(`v`);if(!r)return;let i=()=>{!window.YT?.Player||!document.getElementById(`youtube-player`)||(T.current=new window.YT.Player(`youtube-player`,{height:`100%`,width:`100%`,videoId:r,playerVars:{autoplay:0,modestbranding:1,rel:0,enablejsapi:1},events:{onReady:e=>{E.current=!0},onStateChange:e=>{e.data===0&&N()},onError:x}}))};if(!document.getElementById(`youtube-api`)){let e=document.createElement(`script`);e.id=`youtube-api`,e.src=`https://www.youtube.com/iframe_api`,document.head.appendChild(e)}return window.YT&&window.YT.Player?i():window.onYouTubeIframeAPIReady=i,()=>{T.current?.destroy&&(T.current.destroy(),E.current=!1)}},r[8]=l,r[9]=A,r[10]=N,r[11]=P):P=r[11];let F;if(r[12]!==l||r[13]!==A?(F=[A,l],r[12]=l,r[13]=A,r[14]=F):F=r[14],(0,h.useEffect)(P,F),!s){let e;r[15]===v?e=r[16]:(e=v(`VideoPlayer.noReference`),r[15]=v,r[16]=e);let t;return r[17]===e?t=r[18]:(t=(0,g.jsx)(`div`,{className:`flex items-center justify-center h-full bg-gray-100`,children:(0,g.jsx)(`p`,{className:`text-gray-500`,children:e})}),r[17]=e,r[18]=t),t}if(j){let e;r[19]===v?e=r[20]:(e=v(`VideoPlayer.loading`),r[19]=v,r[20]=e);let t;return r[21]===e?t=r[22]:(t=(0,g.jsx)(`div`,{className:`flex items-center justify-center h-full bg-gray-100`,children:(0,g.jsx)(`p`,{className:`text-gray-500`,children:e})}),r[21]=e,r[22]=t),t}if(!(A?.getLesson?.contents||[]).find(S)?.url){let e;r[23]===v?e=r[24]:(e=v(`VideoPlayer.noUrl`),r[23]=v,r[24]=e);let t;return r[25]===e?t=r[26]:(t=(0,g.jsx)(`div`,{className:`flex items-center justify-center h-full bg-gray-100`,children:(0,g.jsx)(`p`,{className:`text-gray-500`,children:e})}),r[25]=e,r[26]=t),t}let I;r[27]===Symbol.for(`react.memo_cache_sentinel`)?(I=(0,g.jsx)(`div`,{id:`video-container`,className:`w-full h-full`}),r[27]=I):I=r[27];let L;r[28]!==C||r[29]!==v?(L=C&&(0,g.jsx)(`div`,{className:`absolute top-4 right-4 w-80`,children:(0,g.jsxs)(p,{variant:`default`,className:`bg-white shadow-lg`,children:[(0,g.jsxs)(f,{className:`flex justify-between items-center`,children:[v(`VideoPlayer.completionAlert.title`),(0,g.jsx)(c,{variant:`ghost`,size:`sm`,onClick:()=>w(!1),children:(0,g.jsx)(e,{className:`h-4 w-4`})})]}),(0,g.jsx)(d,{children:v(`VideoPlayer.completionAlert.description`)})]})}),r[28]=C,r[29]=v,r[30]=L):L=r[30];let R;return r[31]===L?R=r[32]:(R=(0,g.jsxs)(`div`,{className:`relative h-full`,children:[I,L]}),r[31]=L,r[32]=R),R};var y=v;function b(e){return e?.url?.toLowerCase().includes(`youtube.com/watch`)}function x(e){console.error(`Player error:`,e)}function S(e){return e?.url?.toLowerCase().includes(`youtube.com/watch`)}export{v as VideoPlayer,y as default,_ as formatTimeFromSeconds};